<%= form_with(model: [ :admin, @song ], local: true) do |form| %>
  <% if form.object.errors.any? %>
        <div>
            <% form.object.errors.full_messages.each do |message|  %>
            <div class="text-red-500"><%= message %></div>
            <% end %>
        </div>
    <% end %>

  <div class="">

    <% if @song.song_image_url.present? %>
      <div id="<%= dom_id(@song, :song_image) %>" class="flex flex-col justify-center items-center">
          <%= image_tag safe_image_url(@song.song_image_url), class: "w-1/3 py-2" %>
          <%= link_to "Remove image", destroy_image_admin_song_path(@song), class: "border border-input-background rounded bg-red-400 py-1 px-2 my-2", data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
      </div>
    <% end %>

    <div class="rounded-sm p-2" data-controller="file-upload">
      <div class="flex items-center my-4">
        <%= label_tag :song_image_upload, "Select Image" %>&nbsp;
        <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V8m0 8h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
          <span class="text-sm">w-640 x h-640 - 5MB max</span>
        </svg>
      </div>
      <%= file_field_tag :song_image_upload,
          class: "block w-full text-sm border rounded-sm cursor-pointer text-zinc-800 focus:outline-none bg-gray-100 border-gray-100",
          accept: "image/jpeg,image/png,image/webp",
          data: {
            target: "#song_song_image_url",
            action: "change->file-upload#upload"
          } %>
          
      <div class="upload-status" id="image-upload-status"></div>
      
      <%= form.hidden_field :song_image_url %>
    </div>

    <% if @song.song_file_url.present? %>
      <div id="<%= dom_id(@song, :song_file) %>" class="flex flex-col justify-center items-center">
        <div class="w-1/3 py-2">
          <audio controls class="w-full">
            <source src="<%= safe_image_url(@song.song_file_url) %>" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
        
        <%= link_to "Remove audio file",
                    destroy_file_admin_song_path(@song),
                    class: "border border-input-background rounded bg-red-400 py-1 px-2 my-2",
                    data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
      </div>
    <% end %>
    
    <div class="rounded-sm p-2" data-controller="file-upload">
      <div class="flex items-center my-4">
        <%= label_tag :song_file_upload, "Select Audio File" %>&nbsp;
        <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V8m0 8h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
          <span class="text-sm">MP3, WAV, OGG, M4A - 50MB max</span>
        </svg>
      </div>
      <%= file_field_tag :song_file_upload,
          class: "block w-full text-sm border rounded-sm cursor-pointer text-zinc-800 focus:outline-none bg-gray-100 border-gray-100",
          accept: "audio/mpeg,audio/mp3,audio/wav,audio/ogg,audio/m4a",
          data: {
            target: "#song_song_file_url",
            action: "change->file-upload#upload"
          } %>

      <div class="upload-status" id="file-upload-status"></div>
      
      <%= form.hidden_field :song_file_url %>
    </div>
    <div class="border border-gray-100 rounded-sm p-2 mt-1">
      <h2 class="text-xl font-medium text-gray-100 align-middle text-center p-2">Song Details</h2>
      <div class="flex justify-between items-center my-2">
        <%= form.label :artist_name, "Artist Name", class: "w-52" %>
        <%= form.text_field :artist_name, value: @song.artist&.name, class: "rounded-sm border border-slate-600 bg-gray-100 text-zinc-800 w-full" %>
      </div>
      
      <% if @song.artist&.image_url.present? %>
        <div id="<%= dom_id(@song, :artist_image) %>" class="flex flex-col justify-center items-center">
            <%= image_tag safe_image_url(@song.artist.image_url), class: "w-1/3 py-2" %>
            <%= link_to "Remove artist image", destroy_artist_image_admin_song_path(@song), class: "border border-input-background rounded bg-red-400 py-1 px-2 my-2", data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
        </div>
      <% end %>

      <div class="rounded-sm p-2 my-2" data-controller="file-upload">
        <div class="flex items-center my-4">
          <%= label_tag :artist_image_upload, "Select Artist Image" %>&nbsp;
          <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V8m0 8h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
            <span class="text-sm">300px high recommended for banners - 5MB max</span>
          </svg>
        </div>
        <%= file_field_tag :artist_image_upload,
            class: "block w-full text-sm border rounded-sm cursor-pointer text-zinc-800 focus:outline-none bg-gray-100 border-gray-100",
            accept: "image/jpeg,image/png,image/webp",
            data: {
              target: "#artist_image_url",
              action: "change->file-upload#upload"
            } %>
            
        <div class="upload-status" id="artist-image-upload-status"></div>
        
        <%= hidden_field_tag :artist_image_url %>
      </div>
      
      <% if @song.artist&.banner_video_url.present? %>
        <div id="<%= dom_id(@song, :artist_banner_video) %>" class="flex flex-col justify-center items-center">
          <div class="w-1/2 py-2">
            <video class="w-full h-auto max-h-64" controls>
              <source src="<%= safe_image_url(@song.artist.banner_video_url) %>" type="video/mp4">
              Your browser does not support the video element.
            </video>
          </div>
          <%= link_to "Remove banner video", destroy_artist_banner_video_admin_song_path(@song), class: "border border-input-background rounded bg-red-400 py-1 px-2 my-2", data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
        </div>
      <% end %>

      <div class="rounded-sm p-2 my-2" data-controller="file-upload">
        <div class="flex items-center my-4">
          <%= label_tag :artist_banner_video_upload, "Select Artist Banner Video" %>&nbsp;
          <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V8m0 8h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
            <span class="text-sm">1280x300 recommended - 20MB MP4 max</span>
          </svg>
        </div>
        <%= file_field_tag :artist_banner_video_upload,
            class: "block w-full text-sm border rounded-sm cursor-pointer text-zinc-800 focus:outline-none bg-gray-100 border-gray-100",
            accept: "video/mp4",
            data: {
              target: "#artist_banner_video_url",
              action: "change->file-upload#upload"
            } %>
            
        <div class="upload-status" id="artist-banner-video-upload-status"></div>
        
        <%= hidden_field_tag :artist_banner_video_url %>
      </div>
      
      <div class="flex justify-between items-center my-2">
        <%= form.label :album_title, "Album Title", class: "w-52" %>
        <%= form.text_field :album_title, value: @song.album&.title, class: "rounded-sm border border-slate-600 bg-gray-100 text-zinc-800 w-full" %>
      </div>
      
      <% if @song.album&.cover_art_url.present? %>
        <div id="<%= dom_id(@song, :album_cover) %>" class="flex flex-col justify-center items-center">
            <%= image_tag safe_image_url(@song.album.cover_art_url), class: "w-1/3 py-2" %>
            <%= link_to "Remove album cover", destroy_album_cover_admin_song_path(@song), class: "border border-input-background rounded bg-red-400 py-1 px-2 my-2", data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
        </div>
      <% end %>

      <div class="rounded-sm p-2 my-2" data-controller="file-upload">
        <div class="flex items-center my-4">
          <%= label_tag :album_cover_upload, "Select Album Cover" %>&nbsp;
          <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V8m0 8h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
            <span class="text-sm">640x640 recommended - 5MB max</span>
          </svg>
        </div>
        <%= file_field_tag :album_cover_upload,
            class: "block w-full text-sm border rounded-sm cursor-pointer text-zinc-800 focus:outline-none bg-gray-100 border-gray-100",
            accept: "image/jpeg,image/png,image/webp",
            data: {
              target: "#album_cover_url",
              action: "change->file-upload#upload"
            } %>
            
        <div class="upload-status" id="album-cover-upload-status"></div>
        
        <%= hidden_field_tag :album_cover_url %>
      </div>
      
      <div class="flex justify-between items-center my-2">
        <%= form.label :title, class: "w-52" %>
        <%= form.text_field :title, class: "rounded-sm border border-slate-600 bg-gray-100 text-zinc-800 w-full" %>
      </div>
      <div class="flex justify-between items-center my-2">
        <%= form.label :genre_ids, "Genres" %>
        <%= form.collection_select :genre_ids, Genre.all, :id, :name, {}, { multiple: true } %>
      </div>
      <div class="flex justify-between items-center my-2">
        <%= form.label :public, "Public", class: "w-52" %>
        <%= form.check_box :public, class: "rounded-sm border border-slate-600 bg-gray-100 text-zinc-800" %>
        <span class="text-sm text-gray-300 ml-2">Check to make this song publicly accessible</span>
      </div>
    </div>
    <%= form.submit "Submit", class: "border border-gray-100 bg-slate-900 text-gray-100 rounded-sm px-6 py-2 mt-2" %>
  </div>
<% end %>